var recipes={onReady:function(){recipes.addInputs(),recipes.imageUploader(),recipes.ordering(),recipes.removeBtn(),recipes.starRating()},addInputs:function(){jQuery(".btn-ingredient").click(function(e){e.preventDefault();var a=jQuery(this).attr("data-count");jQuery("#ingredientListing").append('<article class="ingredient"><div class="move"><i class="fa fa-bars"></i></div><input type="text" class="measurement" name="ingredients['+a+'][measure]" placeholder="measurement" /><span>-</span><input type="text" class="ingredientTitle" name="ingredients['+a+'][ingredient_title]" placeholder="ingredient" /><div class="remove"><i class="fa fa-close"></i></div></article>'),a++,jQuery(this).attr("data-count",a)}),jQuery(".btn-instruction").click(function(e){e.preventDefault(),jQuery("#instructionListing").append('<article class="instruction"><div class="move"><i class="fa fa-bars"></i></div><input type="text" name="instructions[]" placeholder="cooking step" /><div class="remove"><i class="fa fa-close"></i></div></article>')})},imageUploader:function(){var e;jQuery(".upload-image").click(function(a){a.preventDefault();var t=jQuery(this).parent().attr("data-post"),r=jQuery(".photoWrap").children().length;e=wp.media.frames.meta_image_frame=wp.media({library:{type:"image"},multiple:!1}),e.open(),e.on("select",function(){var a=e.state().get("selection").first().toJSON();jQuery(".photoWrap").append('<article class="photo ui-state-default" data-order="'+r+'"><img src="'+a.url+'" alt="" /><div class="remove" data-key="'+r+'"><i class="fa fa-close"></i></div></article>'),recipes.saveImage(t,a.url),e.close()})})},saveImage:function(e,a){jQuery.ajax({url:ajaxurl,type:"GET",data:{postID:e,fieldVal:a,action:"setImage"},dataType:"html",success:function(){recipes.removeItem()},error:function(e,a,t){window.alert(e+" :: "+a+" :: "+t)}})},removeItem:function(e,a,t){jQuery.ajax({url:ajaxurl,type:"GET",data:{action:"removeItem",postID:e,type:t,key:a},dataType:"html",error:function(e,a,t){window.alert(e+" :: "+a+" :: "+t)}})},removeBtn:function(){jQuery(".remove").click(function(e){e.preventDefault();var a=jQuery(this).parent().parent().attr("data-post"),t=jQuery(this).parent().parent().attr("data-type"),r=jQuery(this).attr("data-key");jQuery(this).parent().remove(),recipes.removeItem(a,r,t)})},saveOrder:function(e,a,t){jQuery.ajax({url:ajaxurl,type:"GET",data:{order:e,type:a,postID:t,action:"setOrder"},dataType:"JSON"})},ordering:function(){jQuery(".sortable").sortable({placeholder:"ui-state-highlight",update:function(e,a){var t=[];jQuery("article",this).each(function(){t.push(jQuery(this).attr("data-order"))});var r=jQuery(this).attr("data-post"),i=jQuery(this).attr("data-type");recipes.saveOrder(t,i,r)}}),jQuery(".sortable").disableSelection()},saveRating:function(e,a){jQuery.ajax({url:ajaxurl,type:"GET",data:{action:"setRating",postID:e,rating:a},dataType:"html",error:function(e,a,t){window.alert(e+" :: "+a+" :: "+t)}})},starRating:function(){jQuery("#starRating i").click(function(e){e.preventDefault();var a=jQuery("#starRating").attr("data-post"),t=jQuery(this).attr("data-star");jQuery("#starRating .fa-star").removeClass("fa-star").addClass("fa-star-o"),jQuery(this).removeClass("fa-star-o").addClass("fa-star"),jQuery(this).prevAll().removeClass("fa-star-o").addClass("fa-star"),jQuery("#recipe_rating").val(t),recipes.saveRating(a,t)});var e=jQuery("#recipe_rating").val();jQuery('#starRating i[data-star="'+e+'"]').removeClass("fa-star-o").addClass("fa-star").prevAll().removeClass("fa-star-o").addClass("fa-star")}};jQuery(document).ready(function($){recipes.onReady()});